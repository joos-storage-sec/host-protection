# host-protection
Защита хоста

**Информационная безопасность**

**Информационная безопасность (Information Security, InfoSec)** — методы защиты информации путём уменьшения информационных рисков.

**Кибербезопасность (Computer security, cybersecurity)** — методы защиты компьютерных систем, их программного и аппаратного обеспечения, хранимых и передаваемых данных от компьютерных атак

- **Субъект** — пытается получить доступ к **объекту**
- **Объект** — то, к чему ограничивается или отслеживается **доступ**
- **Доступ** — операция чтения, записи, создания, удаления, модификации и т. д.

**ИБ: свойства информации**
- Конфиденциальность — состояние информации, при котором доступ к ней возможен только со стороны авторизованных на это субъектов.
- Доступность — возможность беспрепятственного доступа к информации для субъекта, имеющего необходимые права.
- Целостность — отсутствие неправомерного искажения, добавления, удаления информации.

**ИБ: угроза безопасности информации**
- Угроза безопасности информации — совокупность условий и факторов, создающих потенциальную или реально существующую опасность нарушения информационной безопасности (ГОСТ Р 50922-96).
- Угроза = вероятность + опасность
- Наличие угрозы не подразумевает атаку на систему, но говорит о её вероятности.
- Угроза ➡ (вероятность) ➡ ущерб

**ИБ: источник угрозы безопасности информации**
- Источник угрозы безопасности информации — субъект, являющийся непосредственной причиной возникновения угрозы безопасности информации: авторизованный пользователь, злоумышленник, насекомое.
- Уязвимость информационной системы — свойство системы, обусловливающее возможность реализации угроз безопасности информации

**Защита хоста**

**Антивирус** — средство защиты, предназначенное для определения и блокирования вредоносного ПО: вирусов, троянов, червей и т. д.

Основные подходы к обнаружению вредоносного ПО:
- сигнатурный — проверка по БД индикаторов
- поиск аномалий — анализ поведения
Варианты установки:
- на хосте
- на сервере, обычно подключаются как отдельные модули

**Хостовая система обнаружения вторжений (Host-based intrusion detection system, HIDS)** — средство защиты, предназначенное для анализа событий в динамике, происходящих на хосте.

Основные подходы к обнаружению вредоносного ПО:
- наблюдение за участками памяти
- наблюдение за выбранными файлами
- наблюдение за поведением системы
- наблюдение за логами

Песочница (sandbox) — тестовая среда для запуска ПО, изолированная от основной системы.

Дистрибутивы:
- seccomp (средство ядра Linux, ограничивает системные вызовы)
- Sandboxie
- Shade sandbox

**SELinux** — это система принудительного контроля доступа, реализованная на уровне ядра.

SELinux применяет систему дополнительной маркировки объектов ОС и определяет правила доступа каждого процесса к объектам на основе присвоенных меток. Такие правила объединяются и называются политикой

Режимы работы:
- Disabled
- Enforcing — блокировка в соответствии с заданными политикам
- Permissive — логирование в соответствии с заданными политикам.

**AppArmor** — модуль ядра Linux, обеспечивающий управление доступом на основе имён. Т. е. для каждой программы создаётся свой профиль, в котором указываются уровни доступа к каталогам, программам и системным ресурсам.
```
user@user:~$ sudo apt install apparmor-profiles apparmor-utils
apparmor-profiles-extra
```
Ссылка: gitlab.com/apparmor/apparmor

AppArmor: режимы работы
- Режим обучения (сообщения о действиях приложения):
```
user@user:~$ sudo aa-complain <путь к файлу>
```
- Режим ограничения согласно профилю:
```
user@user:~$ sudo aa-enforce <путь к файлу>
```
**PAM (Pluggable Authentication Modules, подключаемые модули аутентификации)** — набор библиотек, с помощью которых можно настроить методы аутентификации пользователей.

Типы модулей PAM:
- модули учётных записей
- модули аутентификации
- модули паролей
- модули сессий

**Ограничение попыток входа**

Структура каталогов PAM:
- /etc/pam.d/ — файлы конфигураций приложений
- /lib/security/ — модули PAM
- /etc/security/ — файлы конфигураций для PAM-окружений
- /usr/share/doc/pam-*/ — документация

**Шифрование**

**eCryptfs** — это POSIX-совместимая файловая система вложенного (stacked) шифрования. eCryptfs защищает файлы для любой файловой системы, раздела и т. д.

Установка:
```
user@user:~$ sudo apt install ecryptfs-utils
```
Шифрование домашнего каталога

Создание нового пользователя:
```
user@user:~$ sudo adduser --encrypt-home user2
```
Проверка шифрования:
```
user@user:~$ su - user2
user2@user:~$ touch 123, 456
user2@user:~$ exit
user@user:~$ sudo ls /home/user2/
Access-Your-Private-Data.desktop README.txt
```
Миграция домашнего каталога пользователя:
```
user@user:~$ sudo ecryptfs-migrate-home -u user1
```
Шифрование раздела swap:
```
user@user:~$ sudo ecryptfs-setup-swap
```
Информация для восстановления:
```
user@user:~$ ecryptfs-unwrap-passphrase
```
**LUKS (Linux Unified Key Setup)** — спецификация формата шифрования дисков, используемая в ОС Linux. При помощи LUKS могут быть зашифрованы диски, работающие в ОС Linux как в настольных компьютерах, так и в разнообразных устройствах, например, сетевых накопителях

**Установка LUKS**

Подготовка диска:
```
user@user:~$ sudo apt install gparted
```
Установка LUKS (должна быть установлено по умолчанию):
```
user@user:~$ sudo apt-get install cryptsetup
```
Проверка установки:
```
user@user:~$ cryptsetup --version
```
**Шифрование раздела LUKS**

Подготовка раздела (luksFormat):
```
user@user:~$ sudo cryptsetup -y -v --type luks2 luksFormat /dev/sdb1
```
Монтирование раздела:
```
user@user:~$ sudo cryptsetup luksOpen /dev/sdb1 disk
user@user:~$ ls /dev/mapper/disk
```
Форматирование раздела:
```
user@user:~$ sudo dd if=/dev/zero of=/dev/mapper/disk
user@user:~$ sudo mkfs.ext4 /dev/mapper/disk
```
Шифрование раздела LUKS

Монтирование «открытого» раздела:
```
user@user:~$ mkdir .secret
user@user:~$ sudo mount /dev/mapper/disk .secret/
```
Завершение работы:
```
user@user:~$ sudo umount .secret
user@user:~$ sudo cryptsetup luksClose disk
```
